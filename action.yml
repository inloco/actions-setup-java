name: Setup Java
description: Setup Java SDK
author: Incognia
inputs:
  java-version:
    description: "The Java version to set up. Takes a whole or semver Java version. See examples of supported syntax in actions/setup-java's README"
    required: true
  distribution:
    description: "Java distribution. See the list of supported distributions in actions/setup-java's README"
    default: 'adopt'
  cache:
    description: 'Whether to enable caching'
    default: true
  path:
    description: 'A list of files, directories, and wildcard patterns to cache and restore'
    default: |
      **/.gradle
      **/build
      !**/build/jib*
  key:
    description: 'An explicit key for restoring and saving the cache'
    default: ${{ runner.os }}-action-build-${{ github.sha }}
  restore-keys:
    description: 'An ordered list of keys to use for restoring the cache if no cache hit occurred for key'
    default: |
      ${{ runner.os }}-action-build-
runs:
  using: composite
  steps:
  - name: Setup Java proper
    uses: actions/setup-java@v2
    with:
      java-version: ${{ inputs.java-version }}
      distribution: ${{ inputs.distribution }}
      cache: |
        ${{ inputs.cache ? 'gradle' : null }}

  - name: Set Gradle's console output to 'plain'
    shell: bash
    run: |
      mkdir -p ~/.gradle
      printf "\n%s" "org.gradle.console=plain" >> ~/.gradle/gradle.properties

  - name: Cache gradle build
    uses: inloco/actions-cache@HEAD
    if: inputs.cache
    with:
      path: ${{ inputs.path }}
      key: ${{ inputs.key }}
      restore-keys: ${{ inputs.restore-keys }}
